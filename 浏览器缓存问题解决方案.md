# 浏览器缓存问题解决方案

## 问题现象
```
Uncaught ReferenceError: startMapServer is not defined
Uncaught ReferenceError: refreshMapList is not defined
```

## 根本原因
- JavaScript文件已经更新
- 但浏览器加载的是缓存中的旧文件
- 导致HTML中引用的新函数在旧JS文件中不存在

## 立即解决方案

### 方案1: 强制刷新（推荐）
按以下快捷键之一：
- **Windows/Linux**: `Ctrl + Shift + R` 或 `Ctrl + F5`
- **Mac**: `Cmd + Shift + R`

这会绕过缓存，重新下载所有资源。

### 方案2: 清除浏览器缓存
1. 按 `F12` 打开开发者工具
2. 右键点击浏览器地址栏旁的刷新按钮
3. 选择"清空缓存并硬性重新加载"

### 方案3: 使用隐私模式（无痕模式）
- **Chrome/Edge**: `Ctrl + Shift + N`
- **Firefox**: `Ctrl + Shift + P`

隐私模式不会使用缓存，每次都重新加载。

### 方案4: 禁用缓存（开发时推荐）
1. 按 `F12` 打开开发者工具
2. 点击"Network"（网络）标签
3. 勾选"Disable cache"（禁用缓存）
4. 保持开发者工具打开状态

## 长期解决方案

### 给静态文件添加版本号
修改HTML文件，给JavaScript文件添加版本参数：

```html
<!-- 当前 -->
<script src="/static/control.js"></script>

<!-- 改为 -->
<script src="/static/control.js?v=20251215"></script>
```

每次更新代码时，修改版本号即可强制浏览器重新加载。

## 快速检查

在浏览器控制台（F12 → Console）输入：
```javascript
// 检查函数是否存在
typeof startMapServer    // 应该返回 "function"
typeof stopMapServer     // 应该返回 "function"
typeof refreshMapList    // 应该返回 "function"
```

如果返回 `"undefined"`，说明浏览器仍在使用旧缓存。

## 测试步骤

1. **强制刷新**: `Ctrl + Shift + R`
2. **检查函数**:
   ```javascript
   typeof startMapServer    // 应该是 "function"
   ```
3. **测试功能**:
   - 点击"刷新列表"按钮 → 应该正常工作
   - 点击"启动地图服务器"按钮 → 应该正常工作

## 为什么会有缓存问题？

浏览器为了提高性能，会缓存静态资源（JS、CSS、图片等）。当文件更新时，如果文件名和URL没变，浏览器可能继续使用缓存的旧版本。

**触发缓存的情况**：
- 正常刷新（F5）
- 点击链接
- 前进/后退按钮

**不使用缓存的情况**：
- 强制刷新（Ctrl+Shift+R）
- 隐私模式
- 禁用缓存时
- URL参数改变（如 `?v=2`）

## 预防措施

### 开发时
- 始终使用开发者工具的"Disable cache"选项
- 或使用隐私模式测试

### 生产环境
- 给静态文件添加版本号或哈希值
- 配置服务器设置合适的缓存策略
- 使用构建工具自动管理版本号

---
**记住**: 更新代码后，第一次测试时务必使用 `Ctrl + Shift + R` 强制刷新！





